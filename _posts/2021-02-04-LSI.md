---
layout: post
title: "[ML/stat] Indexing by Latent Semantic Analysis"
categories: doc
tags: ['ml', 'stat']
comments: true
use_math: true
---

*Indexing by Latent Semantic Analysis(1990)* í˜ì´í¼ë¥¼ ì½ê³  ë‚˜ë¦„ëŒ€ë¡œ ê³µë¶€í•œ ë‚´ìš©ì…ë‹ˆë‹¤ ğŸ˜€

## 1. Indexing and Retrieval

ì´ ë…¼ë¬¸ì—ì„œëŠ” ë¬¸ì„œ ê²€ìƒ‰ ë¬¸ì œì˜ ì´ìŠˆë¥¼ í¬ê²Œ **synonymy**ì— ì˜í•œ ê²ƒê³¼  **polysemy**ì— ì˜í•œ ê²ƒìœ¼ë¡œ ë¶„ë¥˜í•œë‹¤. **Synonymy** ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì–¸ì–´ì  í‘œí˜„ë“¤ì´ ìœ ì‚¬í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ” ë§í•œë‹¤. ê°™ì€ ì˜ë¯¸ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë‹¤ë¥¸ í‘œí˜„ì˜ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´, ì‹¤ì œë¡œ ê´€ê³„ê°€ ìˆëŠ” ë¬¸ì„œê°€ ê´€ê³„ê°€ ì—†ëŠ” ë¬¸ì„œë¡œ ë¶„ë¥˜ë  ìˆ˜ ìˆë‹¤. ì¦‰ **Synonymy**ëŠ” FN ì¼€ì´ìŠ¤ë¥¼ ë°œìƒì‹œì¼œ ì¬í˜„ìœ¨ì„ ë–¨ì–´ëœ¨ë¦¬ëŠ” ì›ì¸ì´ ëœë‹¤. **Polysemy**ëŠ” ë°˜ëŒ€ë¡œ í•˜ë‚˜ì˜ ì–´íœ˜ê°€ ì—¬ëŸ¬ ì˜ë¯¸ë¥¼ ê°€ë¦¬í‚¬ ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤. ì´ ê²½ìš°ì—ëŠ” ì‹¤ì œë¡œ ê´€ê³„ê°€ ì—†ëŠ” ë¬¸ì„œì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ê°™ì€ ì–´íœ˜ê°€ ì‚¬ìš©ë˜ì—ˆë‹¤ëŠ” ì´ìœ ë¡œ ì¸í•´ ê´€ê³„ê°€ ìˆëŠ” ë¬¸ì„œë¡œ ë¶„ë¥˜ë  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤. ì¦‰ **Polysemy**ëŠ”  FP ì¼€ì´ìŠ¤ë¥¼ ë°œìƒì‹œì¼œ ì •ë°€ë„ë¥¼ ë–¨ì–´ëœ¨ë¦¬ëŠ” ì›ì¸ì´ ëœë‹¤.

## 2. Latent Semantic Indexing

ì´ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” LSI(latent semantic indexing)ì€ **Synonymy** ì´ìŠˆì— ì´ˆì ì„ ë§ì¶˜ ë°©ë²•ì´ë‹¤. ì¦‰ ì„œë¡œ ë‹¤ë¥¸ ë‹¨ì–´ë“¤ë¡œ í‘œí˜„ëœ ê²€ìƒ‰ì–´ë“¤ê³¼ ë¬¸ì„œë“¤ ë’¤ì— ìˆ¨ê²¨ì§„ ê³µí†µì˜ ì ì¬ì  ì˜ë¯¸ë¥¼ ì°¾ì•„ë‚´ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ í†µí•´ ê²€ìƒ‰ì–´ì™€ ë¬¸ì„œì— ì‚¬ìš©ëœ ì–´íœ˜ê°€ ì •í™•íˆ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ë„ ì–‘ìì˜ ì˜ë¯¸ê°€ í†µí•œë‹¤ë©´ ë§¤ì¹­ì„ ì‹œì¼œì¤„ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì ì¬ì ì¸ ì˜ë¯¸ë¼ëŠ” ê²ƒì„ ì–´ë–»ê²Œ ëª¨ë¸ë§í•  ìˆ˜ ìˆì„ê¹Œ? ë¶„ì„ì€ term-document í–‰ë ¬ì—ì„œ ì‹œì‘í•œë‹¤. 


```python
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd

plt.style.use("seaborn-white")
```


```python
X = np.array([
    [1, 0, 0, 1, 0, 0, 0, 0, 0],
    [1, 0, 1, 0, 0, 0, 0, 0, 0],
    [1, 1, 0, 0, 0, 0, 0, 0, 0],
    [0, 1, 1, 0, 1, 0, 0, 0, 0],
    [0, 1, 1, 2, 0, 0, 0, 0, 0],
    [0, 1, 0, 0, 1, 0, 0, 0, 0],
    [0, 1, 0, 0, 1, 0, 0, 0, 0],
    [0, 0, 1, 1, 0, 0, 0, 0, 0],
    [0, 1, 0, 0, 0, 0, 0, 0, 1],
    [0, 0, 0, 0, 0, 1, 1, 1, 0],
    [0, 0, 0, 0, 0, 0, 1, 1, 1],
    [0, 0, 0, 0, 0, 0, 0, 1, 1],
])
columns = [f"c{i}" for i in range(1, 6)] + [f"m{i}" for i in range(1, 5)]
index = ["human", "interface", "computer", "user", "system", "response", "time", "EPS", "survey", "trees", "graph", "minors"]
X = pd.DataFrame(X, columns=columns, index=index)
```

Category | Colnames | Titles
--- | --- | ---
Human-computer interaction| c1 | ***Human*** maching ***interface*** for Lab ABC ***computer*** applications
Human-computer interaction| c2 | A ***survey*** of user opinion of ***computer system response time*** 
Human-computer interaction| c3 | The ***EPS user interface*** management ***system***
Human-computer interaction| c4 | ***System*** and ***human system*** engineering testing of ***EPS***
Human-computer interaction| c5 | Relation of ***user***-perceived ***response time*** to error measurement
Graph| m1 | The generation of random, binary, unordered ***trees***
Graph| m2 | The intersection ***graph*** of paths in ***trees***
Graph| m3 | ***Graph minors*** IV: Widths of ***trees*** and well-quasi-ordering
Graph| m4 | ***Graph minors***: A ***survey***

ë…¼ë¬¸ì— ì‚¬ìš©ëœ ì˜ˆì‹œë¥¼ ë³´ì. Term-document í–‰ë ¬ì˜ \\(i, j \\) ì…€ ê°’ì€ \\( i \\) ë²ˆì§¸ í…€ì´ \\( j \\) ë²ˆì§¸ ë¬¸ì„œ ì•ˆì— ë“±ì¥í•˜ëŠ” ë¹ˆë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. (ì´ ì˜ˆì‹œì—ì„œëŠ” ë‘ ê°œ ì´ìƒì˜ ë¬¸ì„œì— ë“±ì¥í•˜ëŠ” ë‹¨ì–´ë“¤ë§Œì„ ëŒ€ìƒìœ¼ë¡œ í–‰ë ¬ì„ ë§Œë“¤ì—ˆë‹¤). ì»¬ëŸ¼ì˜ c1\~c5 human-computer interaction ì— ê´€í•œ ë…¼ë¬¸ë“¤ì´ê³ , m1\~m4ëŠ” ê·¸ë˜í”„ì— ê´€í•œ ë…¼ë¬¸ë“¤ì´ë‹¤. í–‰ ë²¡í„°ë“¤ ê°„ì˜ ìœ ì‚¬ë„ëŠ” ê³§ í…€ ê°„ì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚´ê³ , ì—´ ë²¡í„°ë“¤ ê°„ì˜ ìœ ì‚¬ë„ëŠ” ë¬¸ì„œë“¤ ê°„ì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤ëŠ” ì ì„ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤.


```python
X
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
      <th>c4</th>
      <th>c5</th>
      <th>m1</th>
      <th>m2</th>
      <th>m3</th>
      <th>m4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>human</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>interface</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>computer</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>user</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>system</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>response</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>time</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>EPS</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>survey</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>trees</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>graph</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>minors</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



í•˜ì§€ë§Œ í˜„ì‹¤ì ìœ¼ë¡œ ì‚¬ìš©ìì˜ ì§ˆì˜ì™€ ë¬¸ì„œì˜ ì œëª©ì´ ì™„ë²½íˆ ì¼ì¹˜í•˜ê¸°ëŠ” ì–´ë µë‹¤. ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ëŠ” ì‚¬ìš©ìë“¤ì€ ìœ ì‚¬í•œ ë‚´ìš©ì— ëŒ€í•´ ê°ê¸° ë‹¤ë¥¸ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ê²€ìƒ‰ì„ í•  ê²ƒì´ê³ , ë…¼ë¬¸ì„ ì“°ëŠ” ì €ìë“¤ ì—­ì‹œ ë§ˆì°¬ê°€ì§€ë¡œ ìœ ì‚¬í•œ ë‚´ìš©ì— ëŒ€í•´ ë‹¤ë¥¸ ì œëª©ì„ ë½‘ì„ ê²ƒì´ë‹¤. ê³µí†µì˜ ì˜ë¯¸ëŠ” ë¶„ëª… ì¡´ì¬í•˜ì§€ë§Œ, ê°œë³„ì ì¸ ë¬¸ì„œì™€ ì¿¼ë¦¬ëŠ” ì´ë¥¼ ì˜¨ì „íˆ í‘œí˜„í•˜ì§€ ëª»í•˜ëŠ” ë¶ˆì™„ì „í•œ ê¸°í‘œì´ë‹¤. í•˜ì§€ë§Œ ì—¬ëŸ¬ ë¬¸ì„œë“¤, ì—¬ëŸ¬ ë‹¨ì–´ë“¤ ê°„ì˜ ê´€ê³„ë¥¼ ë“¤ì—¬ë‹¤ë³´ë©´ ë¬¸ì„œì™€ í…€ì˜ ì˜ë¯¸ë¥¼ ë³´ë‹¤ ì •í™•í•˜ê²Œ íŒŒì•…í•  ìˆ˜ìˆë‹¤. ê°€ë ¹ **í™©ê¸ˆì˜¬ë¦¬ë¸Œ**ì™€ **í™©ì˜¬**ì´ ê°ê° 100ê±´ì˜ ë¬¸ì„œì— í¬í•¨ë˜ì—ˆê³ , **í™©ê¸ˆì˜¬ë¦¬ë¸Œ**ë¥¼ í¬í•¨í•˜ëŠ” ë¬¸ì„œ ì¤‘ **í™©ì˜¬**ë„ í¬í•¨í•˜ëŠ” ë¬¸ì„œê°€ 95ê±´ì´ë¼ê³  ê°€ì •í•´ë³´ì. ìš°ë¦¬ëŠ” ë‘˜ ì‚¬ì´ì— ëª¨ì¢…ì˜ ì—°ê´€ì´ ì¡´ì¬í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆê³ , **í™©ê¸ˆì˜¬ë¦¬ë¸Œ**ì„ ê²€ìƒ‰í•œ ì‚¬ìš©ìì—ê²Œ **í™©ì˜¬**ì„ í¬í•¨í•˜ëŠ” ë¬¸ì„œ ì—­ì‹œ ë³´ì—¬ì¤„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

![](https://i.pinimg.com/originals/a8/e9/46/a8e94600f641ef262ab3e5700ef3b991.jpg)

## 3. SVD or Two-Mode Factor Analysis

$$
\begin{align}
X &= T_0S_0D_0' \\
&=
\begin{bmatrix}
\mathbf{t_1} \space \mathbf{t_2} \space \cdots \space \mathbf{t_r}
\end{bmatrix}
\begin{bmatrix}
    \sigma_{1} & & \\
    & \ddots & \\
    & & \sigma_{r}
  \end{bmatrix}
\begin{bmatrix}
\mathbf{d_1}' \\ 
\mathbf{d_2}' \\ 
\vdots \\
\mathbf{d_r}'
\end{bmatrix}
\\
&= \sigma_1 \mathbf{t_1} \mathbf{d_1}' + \sigma_2 \mathbf{t_2} \mathbf{d_2}'  + \cdots + \sigma_r \mathbf{t_r} \mathbf{d_r}'
\end{align}
$$

ë¬¸ì„œì™€ ë¬¸ì„œ, í…€ê³¼ í…€ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ ì´ ë…¼ë¬¸ì—ì„œ ì„ íƒí•œ ë°©ë²•ì€ íŠ¹ì´ê°’ ë¶„í•´ì´ë‹¤. Term-document í–‰ë ¬ \\( X \in \mathbb{R}^{t \times d} \\)ê°€ ë­í¬ \\( r\\) ì„ ê°€ì§„ë‹¤ê³  í•˜ì. í–‰ë ¬ì€ íŠ¹ì´ê°’ ë¶„í•´ëŠ” ìœ„ ì‹ì²˜ëŸ¼ ì¼ì¢…ì˜ ì„ í˜• ê²°í•©ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. SVDì—ì„œ íŠ¹ì´ê°’ì€ í¬ê¸° ìˆœìœ¼ë¡œ \\( \sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r > 0 \\) ì²˜ëŸ¼ ë°°ì—´í•˜ëŠ” ê²ƒì´ ê´€ë¡€ì´ë‹¤. ë”°ë¼ì„œ íŠ¹ì´ê°’ì´ ì‘ì€ ë’¤ìª½ í•­ë“¤ì€ ì˜ë¼ë‚´ë”ë¼ë„ í–‰ë ¬ì˜ ê°’ì—ëŠ” í° ë³€í™”ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤. í–‰ë ¬ \\( X \in \mathbb{R}^{t \times d} \\)ì— Truncated SVDë¥¼ ì ìš©í•´ì„œ ë­í¬ \\( k (k < r) \\) ì˜ í–‰ë ¬ë¡œ ê·¼ì‚¬í•´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì“¸ ìˆ˜ ìˆë‹¤. ì´ ê²°ê³¼ëŠ” ê¸°ì¡´ì˜ í–‰ë ¬ \\( X \\) ë¥¼ ê·¼ì‚¬í•˜ëŠ” ë­í¬ \\( k \\) í–‰ë ¬ ì¤‘ ê°€ì¥ ì‘ì€ ì œê³±ì˜¤ì°¨ë¥¼ ê°–ëŠ” í–‰ë ¬ì„ì„ ì¦ëª…í•  ìˆ˜ ìˆë‹¤.

$$
\begin{align}
X & \approx \hat{X} \\
&= \sigma_1 \mathbf{t_1} \mathbf{d_1}' + \sigma_2 \mathbf{t_2} \mathbf{d_2}'  + \cdots + \sigma_k \mathbf{t_k} \mathbf{d_k}' \\
&=
\begin{bmatrix}
\mathbf{t_1} \space \mathbf{t_2} \space \cdots \space \mathbf{t_k}
\end{bmatrix}
\begin{bmatrix}
    \sigma_{1} & & \\
    & \ddots & \\
    & & \sigma_{k}
  \end{bmatrix}
\begin{bmatrix}
\mathbf{d_1}' \\ 
\mathbf{d_2}' \\ 
\vdots \\
\mathbf{d_k}'
\end{bmatrix} \\
&= TSD'
\end{align}
$$


```python
# rank 2 approximation
k = 2
T, S, Dt = np.linalg.svd(X) # X = TSD'
D = Dt.T
T = T[:, :k]
S = np.diag(S[:2])
D = D[:, :k]
Xhat = pd.DataFrame(T.dot(S).dot(D.T), index=X.index, columns=X.columns)
Xhat
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>c1</th>
      <th>c2</th>
      <th>c3</th>
      <th>c4</th>
      <th>c5</th>
      <th>m1</th>
      <th>m2</th>
      <th>m3</th>
      <th>m4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>human</th>
      <td>0.162058</td>
      <td>0.400498</td>
      <td>0.378955</td>
      <td>0.467566</td>
      <td>0.175954</td>
      <td>-0.052655</td>
      <td>-0.115143</td>
      <td>-0.159102</td>
      <td>-0.091838</td>
    </tr>
    <tr>
      <th>interface</th>
      <td>0.140585</td>
      <td>0.369801</td>
      <td>0.328996</td>
      <td>0.400427</td>
      <td>0.164972</td>
      <td>-0.032815</td>
      <td>-0.070569</td>
      <td>-0.096768</td>
      <td>-0.042981</td>
    </tr>
    <tr>
      <th>computer</th>
      <td>0.152449</td>
      <td>0.505004</td>
      <td>0.357937</td>
      <td>0.410107</td>
      <td>0.236232</td>
      <td>0.024217</td>
      <td>0.059781</td>
      <td>0.086857</td>
      <td>0.123966</td>
    </tr>
    <tr>
      <th>user</th>
      <td>0.258049</td>
      <td>0.841123</td>
      <td>0.605720</td>
      <td>0.697357</td>
      <td>0.392318</td>
      <td>0.033118</td>
      <td>0.083245</td>
      <td>0.121772</td>
      <td>0.187380</td>
    </tr>
    <tr>
      <th>system</th>
      <td>0.448790</td>
      <td>1.234365</td>
      <td>1.050861</td>
      <td>1.265796</td>
      <td>0.556331</td>
      <td>-0.073790</td>
      <td>-0.154694</td>
      <td>-0.209598</td>
      <td>-0.048880</td>
    </tr>
    <tr>
      <th>response</th>
      <td>0.159554</td>
      <td>0.581682</td>
      <td>0.375219</td>
      <td>0.416898</td>
      <td>0.276541</td>
      <td>0.055904</td>
      <td>0.132218</td>
      <td>0.188911</td>
      <td>0.216908</td>
    </tr>
    <tr>
      <th>time</th>
      <td>0.159554</td>
      <td>0.581682</td>
      <td>0.375219</td>
      <td>0.416898</td>
      <td>0.276541</td>
      <td>0.055904</td>
      <td>0.132218</td>
      <td>0.188911</td>
      <td>0.216908</td>
    </tr>
    <tr>
      <th>EPS</th>
      <td>0.218463</td>
      <td>0.549581</td>
      <td>0.510960</td>
      <td>0.628058</td>
      <td>0.242536</td>
      <td>-0.065411</td>
      <td>-0.142521</td>
      <td>-0.196612</td>
      <td>-0.107913</td>
    </tr>
    <tr>
      <th>survey</th>
      <td>0.096906</td>
      <td>0.532064</td>
      <td>0.229914</td>
      <td>0.211754</td>
      <td>0.266525</td>
      <td>0.136756</td>
      <td>0.314621</td>
      <td>0.444441</td>
      <td>0.424969</td>
    </tr>
    <tr>
      <th>trees</th>
      <td>-0.061254</td>
      <td>0.232108</td>
      <td>-0.138898</td>
      <td>-0.265646</td>
      <td>0.144925</td>
      <td>0.240421</td>
      <td>0.546147</td>
      <td>0.767374</td>
      <td>0.663709</td>
    </tr>
    <tr>
      <th>graph</th>
      <td>-0.064677</td>
      <td>0.335281</td>
      <td>-0.145641</td>
      <td>-0.301406</td>
      <td>0.202756</td>
      <td>0.305726</td>
      <td>0.694893</td>
      <td>0.976611</td>
      <td>0.848750</td>
    </tr>
    <tr>
      <th>minors</th>
      <td>-0.043082</td>
      <td>0.253906</td>
      <td>-0.096667</td>
      <td>-0.207858</td>
      <td>0.151913</td>
      <td>0.221227</td>
      <td>0.502945</td>
      <td>0.706912</td>
      <td>0.615504</td>
    </tr>
  </tbody>
</table>
</div>



ì´ì œ \\( k \\) ì°¨ì› í–‰ë ¬  \\( \hat{X}=TSD' \\) ë¥¼ í†µí•´ **ë¬¸ì„œì™€ ë‹¨ì–´ë¥¼ ê°™ì€ \\( k \\) ì°¨ì›ì˜ ë²¡í„°ë¡œ í‘œí˜„**í•  ê²ƒì´ë‹¤. ë¬¸ì„œ ì¸ë±ì‹±ê³¼ ê²€ìƒ‰ì´ë¼ëŠ” ëª©ì ì„ ìƒê°í•´ë³¼ ë•Œ, ê·¼ì‚¬í•˜ëŠ” ì°¨ì›ì´ ë„ˆë¬´ ì‘ê±°ë‚˜ ë„ˆë¬´ ì»¤ì„œëŠ” ì•ˆëœë‹¤. ì°¨ì›ì€ ë¬¸ì„œ ê°„ì˜ ì˜ë¯¸ ê´€ê³„ë¥¼ í’ë¶€í•˜ê²Œ í‘œí˜„í•  ìˆë„ë¡ ì¶©ë¶„íˆ ì»¤ì•¼ í•˜ì§€ë§Œ, ì§€ë‚˜ì¹˜ê²Œ í° ê³µê°„ì—ì„œëŠ” ìœ ì˜ë¯¸í•œ ìœ ì‚¬ì„±ì„ ë°œê²¬í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§„ë‹¤.

\\( T, D \\) ê°€ ì§êµí–‰ë ¬ì´ê³  \\( S \\) ê°€ ëŒ€ê°í–‰ë ¬ì´ë¯€ë¡œ ì•„ë˜ì˜ ë‘ ì‹ì´ ì„±ë¦½í•œë‹¤. **\\( \hat{X}{'}\hat{X} \\) ì˜ \\( i, j \\) ì…€ì€  \\( \hat{X} \\) ì˜ \\( i \\) í–‰ê³¼ \\( j \\) í–‰ì˜ ë‚´ì ìœ¼ë¡œ, ë‘ í…€ì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë”°ë¼ì„œ \\( TS \\) í–‰ë ¬ì˜ í–‰ë¼ë¦¬ ë‚´ì í•œ ê²°ê³¼ ì—­ì‹œ ë‘ í…€ì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë™ì¼í•˜ê²Œ \\( DS \\) í–‰ë ¬ì˜ í–‰ë¼ë¦¬ ë‚´ì í•œ ê²°ê³¼ëŠ” ë‘ ë¬¸ì„œì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. \\( TS, DS \\) ì˜ í–‰ ë²¡í„°ë“¤ì´ \\( k \\) ì°¨ì›ì˜ ë²¡í„°ì´ë¯€ë¡œ ë‘˜ì„ ê°™ì€ ê³µê°„ì— í‘œí˜„í•  ìˆ˜ ìˆë‹¤.**

$$
\hat{X}\hat{X}' = TS^2T{'} = TS(TS)' \\
\hat{X}'\hat{X} = DS^2D{'} = DS(DS)' \\
$$

\\( k=2 \\) ë¡œ íŠ¹ì´ê°’ ë¶„í•´ë¥¼ í•´ì„œ í…€ê³¼ ë¬¸ì„œì˜ ì¢Œí‘œë¥¼ ê·¸ë ¤ë³´ì. ì‚°ì ë„ë¥¼ ê·¸ë ¤ë³´ë©´ ë…¼ë¬¸ì˜ ê·¸ë¦¼ì„ yì¶•ìœ¼ë¡œ ë’¤ì§‘ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤. ì•„ë§ˆ ë¶€í˜¸ì—ëŠ” ë³„ ì˜ë¯¸ê°€ ì—†ìœ¼ë‹ˆ ë…¼ë¬¸ì—ì„œëŠ” ë³´ê¸° í¸í•˜ë„ë¡ x ê°’ì„ ì–‘ìˆ˜ë¡œ ë°”ê¿”ì¤€ ê²ƒ ê°™ë‹¤. ì•„ë¬´íŠ¼ ì¤‘ìš”í•œ ì ì€, ì¸ê°„-ì»´í“¨í„° ìƒí˜¸ì‘ìš© ê´€ë ¨ ë…¼ë¬¸ë“¤ê³¼ ê·¸ë˜í”„ ê´€ë ¨ ë…¼ë¬¸ë“¤ì´ ì§êµí•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í‘œí˜„ë˜ì—ˆë‹¤ëŠ” ì ì´ë‹¤. í…€ ì—­ì‹œë„ ë§ˆì°¬ê°€ì§€ì˜ ê²½í–¥ì„ ë³´ì¸ë‹¤.


```python
coords = pd.DataFrame(
    np.vstack([T.dot(S), D.dot(S)]), columns=["x", "y"], index = X.index.to_list() + X.columns.to_list()
).assign(label=["term"]*T.shape[0] + ["doc"]*D.shape[0])
```


```python
fig, ax = plt.subplots(nrows=1, figsize=(10,10))
plt.vlines(0, -.8, 1.8, colors="gray", linewidths=1)
plt.hlines(0, -3, .1, colors="gray", linewidths=1)
sns.scatterplot(data=coords, x="x", y="y", palette="Set1", hue="label", style="label", s=150, alpha=0.7)
for x, y, idx in zip(coords.x, coords.y, coords.index):
    plt.text(x +.05, y-0.01, idx, va="center", ha="left", fontsize=12, alpha=0.8)
plt.legend(loc="upper left", fontsize=20)
plt.show()
```


    
![png](/assets/img/docs/2021-02-04-LSI_files/2021-02-04-LSI_11_0.png)
    


ì´ ê³µê°„ì—ì„œ í…€ê³¼ í…€, ë¬¸ì„œì™€ ë¬¸ì„œì˜ ë‚´ì ì€ ë‘˜ ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ê·¸ë ‡ë‹¤ë©´ í…€ê³¼ ë¬¸ì„œ ê°„ì˜ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í• ê¹Œ? í…€ê³¼ ë¬¸ì„œì˜ ìœ ì‚¬ë„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ \\( \hat{X} \\) ì˜ ê° ì…€ì´ ê°€ì§€ëŠ” ê°’ì´ê³ , ì´ëŠ” \\( TS^\frac{1}{2} \\) ê³¼ \\( (DS^\frac{1}{2})' \\)ì˜ í–‰ ë‚´ì ê³¼ ê°™ë‹¤. ì¦‰ **ê°™ì€ ê³µê°„ì—ì„œ \\( TS \\)ì™€ \\( DS \\) ë‚´ì ì€ ë¬¸ì„œì™€ í…€ì˜ ìœ ì‚¬ë„ë¥¼ ì§ì ‘ ë°˜ì˜í•˜ì§€ëŠ” ëª»í•œë‹¤. í•˜ì§€ë§Œ \\( S \\) ê°€ ëŒ€ê°í–‰ë ¬ì´ë¯€ë¡œ ê° ì¶•ì„ \\( S^\frac{1}{2} \\) ë¡œ ìŠ¤ì¼€ì¼ë§ í•œ í›„ ë‚´ì í•˜ë©´ ë¬¸ì„œì™€ í…€ ì‚¬ì´ì˜ ìœ ì‚¬ë„ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.**

$$
\hat{X} = TSD' = TS^\frac{1}{2} (DS^\frac{1}{2})'
$$

## 4. Finding Representations for Pseudo-Documents

$$
\hat{X} = TSD' \\
\hat{X_q} = TSD_q' \\
\therefore D_q = \hat{X_q}'TS^{-1}, \space D_qS = \hat{X_q}'T
$$

í…€ê³¼ ë¬¸ì„œë¥¼ \\( k \\) ì°¨ì› ê³µê°„ì— í‘œí˜„í•¨ìœ¼ë¡œì¨ ê¸°ì¡´ì— ê°€ì§€ê³  ìˆë˜ ê¸°ì¡´ì— ê°€ì§€ê³  ìˆë˜ ë¬¸ì„œì™€ í…€ì— ëŒ€í•œ ì¸ë±ì‹±ì´ ì™„ë£Œë˜ì—ˆë‹¤. ì´ì œ ì‚¬ìš©ìë¡œë¶€í„° ì§ˆì˜ë¥¼ ë°›ì•„ì„œ ë§¤ì¹­ë˜ëŠ” ë¬¸ì„œë¥¼ ë°˜í™˜í•´ì£¼ëŠ” ê³¼ì •ì„ ì‚´í´ë³´ë„ë¡ í•˜ì. ì¿¼ë¦¬ì™€ ë¬¸ì„œë¥¼ ë¹„êµí•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„  ì¿¼ë¦¬ë¥¼ ë™ì¼í•œ \\( k \\) ì°¨ì›ì˜ ë¬¸ì„œ ë²¡í„°ë¡œ í‘œí˜„í•´ì•¼ í•œë‹¤. ê·¸ í›„ ì‹¤ì œ ë¬¸ì„œ ë²¡í„°ì™€ ìœ ì‚¬ë„ë¥¼ ì¸¡ì •í•˜ë©´ ë§¤ì¹­ë˜ëŠ” ë¬¸ì„œë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì‚¬ìš©ìë¡œë¶€í„° ì¿¼ë¦¬ \\( q \\) ê°€ ë“¤ì–´ì™”ë‹¤ê³  ê°€ì •í•´ë³´ì. ì¿¼ë¦¬ëŠ” 0ê°œ ì´ìƒì˜ í…€ì„ í¬í•¨í•˜ëŠ” ì˜ì‚¬ ë¬¸ì„œ(pseudo document)ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. ì´ë¯¸ ê°€ì§€ê³  ìˆëŠ” í…€ì˜ ëª©ë¡ì— ì˜í•´ ì´ë“¤ì´ ì¿¼ë¦¬ì— ë‚˜íƒ€ë‚˜ëŠ” ë¹ˆë„ë¥¼ \\( X_q \\) ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. ìš°ë¦¬ëŠ” ì—¬ê¸°ì—ì„œ ì¶œë°œí•´ ì¿¼ë¦¬ì˜ ì˜ì‚¬ ë¬¸ì„œ í‘œí˜„ì„ ìœ ë„í•˜ê³  ì‹¶ë‹¤. ì‚¬ì‹¤ ìœ ë„ë„ ê²ƒë„ ì—†ê³ , íŠ¹ì´ê°’ ë¶„í•´ \\( \hat{X} = TSD' \\) ì—ì„œ \\( X \\) ì™€ \\( D \\) ëŒ€ì‹  \\( X_q \\) ì™€ \\( D_q \\) ë¥¼ ë„£ì–´ì£¼ë©´ ëœë‹¤.

ì‚¬ìš©ìë¡œë¶€í„° "***human computer*** interaction" ì´ë¼ëŠ” ì¿¼ë¦¬ê°€ ë“¤ì–´ì™”ë‹¤ê³  ê°€ì •í•´ë³´ì. ì¸ë±ìŠ¤ í…€ ì¤‘ ***human, computer***ë¥¼ ê°ê° í•œ ë²ˆì”© í¬í•¨í•˜ë¯€ë¡œ ì¿¼ë¦¬ì˜ ì˜ì‚¬ë¬¸ì„œë²¡í„°ëŠ” ì•„ë˜ ì½”ë“œì²˜ëŸ¼ í‘œí˜„ëœë‹¤. ì¸ê°„-ì»´í“¨í„° ìƒí˜¸ì‘ìš© ê´€ë ¨ ë…¼ë¬¸ë“¤ê³¼ ë¹„ìŠ·í•œ ë°©í–¥ìœ¼ë¡œ í‘œí˜„ë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ì œ ì´ ê³µê°„ì—ì„œ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•´ ê°€ì¥ ê°€ê¹Œìš´ ë¬¸ì„œ ëª‡ ê°œë¥¼ ë°˜í™˜í•´ì£¼ë©´ ëœë‹¤. ë²¡í„° í‘œí˜„ì€ ë‚´ì ìœ¼ë¡œ ìœ ë„í–ˆì§€ë§Œ ë…¼ë¬¸ì—ì„œ ìµœì¢…ì ìœ¼ë¡œëŠ” ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ë‹¤. ë‹¨ì–´ê°€ í•œ ë¬¸ì„œì—ì„œ ëª‡ ë²ˆì´ë‚˜ ë“±ì¥í–ˆëŠ”ì§€ì˜ êµ¬ì²´ì ì¸ ë¹ˆë„ë³´ë‹¤ëŠ” í•´ë‹¹ ë‹¨ì–´ë¥¼ í¬í•¨í•˜ëŠ”ì§€ì˜ ì—¬ë¶€, ê·¸ë¦¬ê³  ì–´ë–¤ ë‹¨ì–´ë“¤ê³¼ í•¨ê»˜ ë“±ì¥í•˜ëŠ”ì§€ë¥¼ ì¤‘ìš”í•˜ê²Œ ë³´ê² ë‹¤ëŠ” ëœ»ì¸ ê²ƒ ê°™ë‹¤.

> To return a set of porential cadidate documents, the pseudo-document formed from a query is compared against all documents, and **those with the highest cosines, that is the nearest vectors, are returned.**


```python
Xq = np.array([1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]).reshape((-1, 1))
Dq = Xq.T.dot(T).dot(np.linalg.inv(S))
DqS = Dq.dot(S)
```



    
![png](/assets/img/docs/2021-02-04-LSI_files/2021-02-04-LSI_15_0.png)
    


